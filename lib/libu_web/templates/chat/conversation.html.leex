<div class="flex justify-center">
    
    <div class="flex flex-col focus:shadow-2xl max-h-screen w-auto shadow-lg rounded-b">
        
        <div class="flex py-4 px-4 items-center flex-none bg-gray-100 rounded-t-lg border-b border-gray-200">
            <div class="flex flex-row">
                
                    <svg xmlns="http://www.w3.org/2000/svg" 
                        viewBox="0 0 24 24" 
                        width="24" 
                        height="24"
                        class="fill-current text-purple-600 h-8 w-8">
                            <path class="heroicon-ui" d="M6 14H4a2 2 0 0 1-2-2V4c0-1.1.9-2 2-2h12a2 2 0 0 1 2 2v2h2a2 2 0 0 1 2 2v13a1 1 0 0 1-1.7.7L16.58 18H8a2 2 0 0 1-2-2v-2zm0-2V8c0-1.1.9-2 2-2h8V4H4v8h2zm14-4H8v8h9a1 1 0 0 1 .7.3l2.3 2.29V8z"/>
                    </svg>
                
                <div class="px-2 text-gray-800 text-sm truncate">
                    <%= @conversation.initial_message.body %>
                </div>
            </div>
            
        </div>
        <!-- Message Container -->
        <div class="bg-white overflow-y-auto max-h-full">
            
            <!-- Messages -->
            <%= for message <- @messages do %>
                    <div class="px-4 py-2 flex items-start text-sm border-l-2 border-transparent hover:border-purple-700 hover:shadow-inner hover:bg-gray-100" 
                        id="message#-<%= message.message_number %>">
                        <img src="https://avatars3.githubusercontent.com/u/20269183?s=460&v=4.jpg" class="w-10 h-10 rounded mr-3">
                        <div class="flex-1 overflow-hidden">
                            <div>
                                <span class="font-bold text-gray-900"><%= message.publisher_id %></span>
                                <span class="text-gray-700 text-xs"><%= time(message.published_on) %></span>
                            </div>
                            <p class="text-gray-900 leading-normal"><%= message.body %></p>
                        </div>
                    </div>
            <% end %>
            
        </div>

        <%= _f = form_for @message_changeset, "#", [
            phx_change: :validate, 
            phx_submit: :new_message,
        ]%>
            <%= text_input(:new_message, :message,
                class: "bg-gray-200 focus:bg-gray-300 shadow-inner border-2 border-transparent w-full leading-tight rounded-b-lg
                        hover:bg-gray-300 rounded-t-none p-4 focus:border-purple-700 text-gray-600 focus:text-gray-800",
                value: @message_changeset.data.message,
                phx_blur: "typing_stopped",
                placeholder: "  Add to the conversation...",
                phx_throttle: 1000
            )%>

            <%= hidden_input :new_message, :publisher_id, value: @current_user.id  %>
            <%= hidden_input :new_message, :conversation_id, value: @conversation.conversation_id %>
            <%= submit "submit", class: "hidden" %>
        </form>
    </div>

</div>